---
title: Setting up mediatomb in Ubuntu 9.10 (Karmic)
date: '2010-03-08T14:19:00.000Z'
author: Rob
tags:
- Linux
- Ubuntu
- UPnP
modified_time: '2013-10-17T21:53:27.448+01:00'
blogger_id: tag:blogger.com,1999:blog-7583560609041238092.post-4175802515620855242
blogger_orig_url: http://robertbeal.blogspot.com/2010/03/setting-up-mediatomb-in-ubuntu-910.html
---

<p>Having recently bought a WDTV HD Live to replace my Xbox (with XBMC) I decided to look into setting up a UPnP service on my Ubuntu headless server.</p> <p>After reading around a bit, I firstly tried uShare but didn't find it very flexible. I finally settled on MediaTomb as I liked the look of the JavaScript import scripts that can be written. I started getting setup so checked out the MediaTomb wiki and a few online tutorials, but struggled to get MediaTomb to work. Either I had missed something, or the articles weren't 100% clear. Here are the steps I took to get it working...</p><a name='more'></a> <h3>Steps</h3> <blockquote>sudo apt-get install mediatomb</blockquote> <p>This will get mediatomb installed, and should set it up as a service. You can stop/start/restart it with:</p> <blockquote>sudo /etc/init.d/mediatomb stop|start</blockquote> <p>Next you need to change the config.xml for MediaTomb. This is located at /etc/mediatomb/config.xml</p> <blockquote>sudo gedit /etc/mediatomb/config.xml</blockquote> <ol>    <li>Set the name of your server in the config. This is near the top under the element &lt;name&gt;.</li>    <li>By default (and this point stumped me for a bit) it won't use import.js to import your videos/music/photos. Instead it will just use the MediaTomb default (which for movies I didn't find very good). If you search for "virtual-layout" and change its attribute "type", from "builtin" to "js", this will cause import.js to be used.</li>    <li>Under the &lt;server&gt; element, add &lt;pc-directory upnp-hide="yes"/&gt;. This hides the annoying PC Directory folder that will otherwise show up when you view your UPnP service.</li></ol> <p>Next you'll want to edit the "import.js" file that defines how your media is imported. This is located at /usr/share/mediatomb/js/import.js.</p> <blockquote>sudo gedit /usr/share/mediatomb/js/import.js</blockquote> <p>Here's my <a href="http://www.robertbeal.com/wp-content/uploads/2010/03/import.js">import.js</a> file. I've only changed the "addVideo" function so far. The code (if you're a developer) should be reasonably easy to read. With all of the above set, restart your MediaTomb service</p> <blockquote>sudo /etc/init.d/mediatomb stop<br/>sudo /etc/init.d/mediatomb start </blockquote> <p>* note you can try "restart" but I've had issues with it.</p> <h3>Importing files</h3> <p>You should now be able to go to the web interface for MediaTomb (http://localhost:49152/), then under the "File System" section add any folders, setup filesystem watchers etc... If you're running the service on your local machine, "Inotify" is probably the better way of getting Mediatomb to watch any folders for updates. However, using Inotify won't work remotely. For example, I ssh onto my server, and often move files around which don't get picked up by Inotify.</p> <p>Set it watching any folders you choose, then wait a minute or two for Mediatomb to import all the data. You can check what the import looks like in the web interface, under the "Database" section.</p> <h3>Autostarting Mediatomb</h3> <blockquote>sudo gedit /etc/default/mediatomb</blockquote> <p>Make sure at the top you have the line - NO_START="no".</p> <p>Also, if you're running Ubuntu it has a bit of a bug, whereby Mediatomb is started before NetworkManager and fails to start as it can't find a working network device. I found the following lines fixed this (moved it back in terms of load order):</p> <blockquote>sudo update-rc.d -f mediatomb remove<br/>sudo update-rc.d mediatomb defaults 99 </blockquote> <p>This fix was taken from the <a title="Mediatomb FAQ" href="http://mediatomb.cc/dokuwiki/faq:faq">Mediatomb wiki FAQ</a> (about 1/4 down the page). You should now have a fully functional UPnP server up and running!</p>